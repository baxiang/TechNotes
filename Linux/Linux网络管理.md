####CentOS 7 虚拟机网络配置
 CentOS 7 安装到了虚拟机里面，结果发现不能联网，一直提示Cannot find a valid baseurl for repo: base/7/x86_64
![image.png](https://upload-images.jianshu.io/upload_images/143845-cd0e4f805997c2d3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
![image.png](https://upload-images.jianshu.io/upload_images/143845-7c8df855e6e2ce81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
cd /etc/sysconfig/network-scripts打开配置文件

vi ifcfg-ens33这里可能你的文件名不是这个，但是找前面是 ifcfg-ens 的就是了
![image.png](https://upload-images.jianshu.io/upload_images/143845-582f107c13702478.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
将文件里的 ONBOOT=no，改为ONBOOT=yes，然后保存并退出
![image.png](https://upload-images.jianshu.io/upload_images/143845-cfd5461101348024.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
![image.png](https://upload-images.jianshu.io/upload_images/143845-3f0b2294197993c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
修改完成之后需要重新启动一下网络服务，才能生效。使用下面的命令。
```
service network restart
```
![image.png](https://upload-images.jianshu.io/upload_images/143845-f4f448b0e7afbb2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

####修改网络配置文件
`vim /etc/sysconfig/network-scripts/ifcfg-ens33`
```
TYPE=Ethernet 类型为以太网
PROXY_METHOD=none
BROWSER_ONLY=no
BOOTPROTO=dhcp 是否自动获取IP(none,static,dhcp)
DEFROUTE=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=yes   //IPV6是否启用
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_FAILURE_FATAL=no
IPV6_ADDR_GEN_MODE=stable-privacy
NAME=ens33
UUID=5042819b-9487-4ded-a61e-404d96b9ccdc 唯一标识符
DEVICE=ens33 // 网卡设备名
ONBOOT=yes 是否随网络服务启动，eho 生效
```
####主机名称配置文件
在Centos6系统中修改主机名称,需要修改配置文件/etc/sysconfig/network 其中NETWORKING用于设置ipv4的默认启用状态，HOSTNAME设置主机名称
```
NETWORKING=yes
HOSTNAME=dev-centos
```
在centos7中 修改/etc/hostname文件
#### DNS配置
hostname查看主机名称
```
# hostname
centos7.baxiang
```
Centos7 修改主机名称
```
sudo vi /etc/hostname`
```
设置DNS服务器,nameserver后面紧跟着DNS服务器
```
cat /etc/resolv.conf
# Generated by NetworkManager
search localhost
nameserver 192.168.1.1 //
```

#### 重启网络服务
centos 7及以上
```
systemctl restart network.service
```
centos 6
```
service network restart
```
####ifconfig
在centos7上，可以使用“ip addr”和“ip link”命令来查找网卡详情。ifconfig命令已经被弃用，如果怀旧需要使用ifconfig，可以执行命令
```
 yum install net-tools
```
```
# ifconfig
ens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.1.111  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 fe80::6da:22a8:bff3:1f1b  prefixlen 64  scopeid 0x20<link>
        ether 00:0c:29:f3:aa:03  txqueuelen 1000  (Ethernet)
        RX packets 21715  bytes 5330755 (5.0 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 83701  bytes 153088426 (145.9 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 64  bytes 5440 (5.3 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 64  bytes 5440 (5.3 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```


查看网卡信息
```
    ifconfig eth0
```
查看所有网卡
```
    ifconfig -a
```
 关闭网卡
```
    ifconfig eth0 down
```
开启网卡
```
    ifconfig eth0 up
```
  修改网卡的IP地址，子网掩码
```
    ifconfig 网络接口名称 ip地址 [netmask 子网掩码]
    ifconfig 网络接口名称 ip地址 [/ 子网掩码长度]
```
为网卡绑定虚拟接口

####关闭和开启网卡
禁用网卡设备
```
ifdown 网卡设备名
```
开启网卡
```
ifup 网卡设备
```
### netstat
查询网络状态
-t 列出TCP协议服务
-u 列出UDP 协议服务
-n 不使用域名与服务名，而使用IP地址和端口号
-l 仅列出在监听状态的网络服务
-a 列出所有的网络连接
-r 列出网关
```
$ netstat -tuln
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN
tcp6       0      0 :::22                   :::*                    LISTEN
tcp6       0      0 ::1:25                  :::*                    LISTEN
udp        0      0 0.0.0.0:68              0.0.0.0:*
udp        0      0 127.0.0.1:323           0.0.0.0:*
udp6       0      0 ::1:323                 :::*
```
显示网关
```
 netstat -rn
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
0.0.0.0         192.168.1.1     0.0.0.0         UG        0 0          0 ens33
192.168.1.0     0.0.0.0         255.255.255.0   U         0 0          0 ens33
$ route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.1.1     0.0.0.0         UG    100    0        0 ens33
192.168.1.0     0.0.0.0         255.255.255.0   U     100    0        0 ens33
```
####DNS 查看
nslookup命令是用来检测域名解析的专业工具,使用nslookup需要安装bind-utils
```
# yum install bind-utils
```
```
# nslookup www.baidu.com
Server:		192.168.1.1
Address:	192.168.1.1#53

Non-authoritative answer:
www.baidu.com	canonical name = www.a.shifen.com.
Name:	www.a.shifen.com
Address: 119.75.217.109
Name:	www.a.shifen.com
Address: 119.75.217.26
```
####traceroute 路由跟踪命令

```
# traceroute www.baidu.com
traceroute to www.baidu.com (119.75.217.26), 30 hops max, 60 byte packets
 1  gateway (192.168.1.1)  5.370 ms  6.794 ms  6.725 ms
 2  113.45.32.1 (113.45.32.1)  9.223 ms  11.093 ms  12.889 ms
 3  218.241.246.122 (218.241.246.122)  12.829 ms  12.874 ms  12.806 ms
 4  218.241.246.125 (218.241.246.125)  7.760 ms  8.391 ms  8.336 ms
 5  14.197.177.89 (14.197.177.89)  6.329 ms 14.197.177.17 (14.197.177.17)  6.503 ms 14.197.178.49 (14.197.178.49)  6.893 ms
 6  14.197.249.94 (14.197.249.94)  6.917 ms 14.197.249.134 (14.197.249.134)  5.461 ms 14.197.249.94 (14.197.249.94)  4.089 ms
 7  * 182.61.253.119 (182.61.253.119)  3.791 ms  3.864 ms
```
####wget 
下载命令
```
# wget https://nginx.org/download/nginx-1.14.2.tar.gz
--2019-01-20 20:40:49--  https://nginx.org/download/nginx-1.14.2.tar.gz
正在解析主机 nginx.org (nginx.org)... 62.210.92.35, 95.211.80.227, 2001:1af8:4060:a004:21::e3
正在连接 nginx.org (nginx.org)|62.210.92.35|:443... 已连接。
已发出 HTTP 请求，正在等待回应... 200 OK
长度：1015384 (992K) [application/octet-stream]
正在保存至: “nginx-1.14.2.tar.gz”

100%[========================================================================================================>] 1,015,384   17.4KB/s 用时 59s

2019-01-20 20:41:49 (16.8 KB/s) - 已保存 “nginx-1.14.2.tar.gz” [1015384/1015384])
```
####tcpdump网络抓包
```
tcpdump -i ens33 -nnx port 22
```
选项
-i指定网卡接口
-nn 将数据包中的域名与服务转换为IP和端口
-X 以十六进制和ASCII 码显示数据包内容
port 指定监听的端口
